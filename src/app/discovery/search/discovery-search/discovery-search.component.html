<div *ngIf="dataIsLoaded; else notLoadedState">
    <div class="row">
        <div class="col-12">
            <div class="card flex-fill">
                <div class="card-header">
                    <!--{{ discovery.state-tittle | translate }}-->
                    <legend class="legend">{{'discovery.search-tittle' | translate}}</legend>
                    <div class="form-row">
                        <label for="actionSearch" class="col-sm-4 control-label">{{ "discovery.action-search-label" |
                            translate
                            }}</label>
                        <div class="form-group col-md-4">
                            <select class="col-4" name="actionSearch"
                                [attr.aria-label]="'discovery.storage' | translate" class="form-control"
                                [(ngModel)]="actionSearch" #type="ngModel" (change)="onActionSelected()">
                                <option value="class">{{ "discovery.action-search-class" | translate }}</option>
                                <option value="instance">{{ "discovery.action-search-instance" | translate }}</option>
                                <option value="lod">{{ "discovery.action-search-lod" | translate }}</option>
                            </select>
                        </div>
                    </div>

                </div>
                <div *ngIf="actionSearch === 'class'">
                    <div class="card-body">

                        <h5 class="card-title">{{'discovery.action-search-class' | translate}}</h5>

                        <form>
                            <div class="form-row">
                                <div class="form-group col-md-4">
                                    <label for="node">{{'discovery.node' | translate}}</label>
                                    <select id="node" name="node" class="form-control"
                                        [(ngModel)]="searchRequest.filter.node" #type="ngModel"
                                        (change)="onNodeSelected()" required>
                                        <option *ngFor="let n of nodes  | keyvalue" [value]="n.key">{{n.key}}</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="tripleStore">{{'discovery.storage' | translate}}</label>
                                    <select id="tripleStore" name="tripleStore" class="form-control"
                                        [(ngModel)]="searchRequest.filter.tripleStore" #type="ngModel"
                                        (change)="onTripleStoreSelected()" [disabled]="!searchRequest.filter.node"
                                        required>
                                        <option *ngFor="let ts of nodes[searchRequest.filter.node]" [value]="ts">
                                            {{ts}}</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="className">{{'discovery.class' | translate}}</label>
                                    <select id="className" name="className" class="form-control"
                                        [(ngModel)]="searchRequest.filter.className" #type="ngModel"
                                        [disabled]="!searchRequest.filter.tripleStore" required>
                                        <option *ngFor="let o of this.objetsList" [value]="o">
                                            {{o}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" value="true" id="doSynchronous"
                                        [checked]="searchRequest.filter.doSynchronous"
                                        (change)="searchRequest.filter.doSynchronous = !searchRequest.filter.doSynchronous">
                                    <label class="form-check-label" for="doSynchronous">
                                        {{'discovery.action-check-sync-label' | translate}}
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" value="true" id="applyDelta"
                                        [checked]="searchRequest.filter.applyDelta"
                                        (change)="searchRequest.filter.applyDelta = !searchRequest.filter.applyDelta">
                                    <label class="form-check-label" for="applyDelta">
                                        {{'discovery.action-check-deltas-label' | translate}}
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" value="true" id="linkEntities"
                                        [checked]="searchRequest.filter.linkEntities"
                                        (change)="searchRequest.filter.linkEntities = !searchRequest.filter.linkEntities">
                                    <label class="form-check-label" for="linkEntities">
                                        {{'discovery.action-check-other-search-label' | translate}}
                                    </label>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary" (click)="launchSearch()"
                                [disabled]="!searchRequest.filter.node || !searchRequest.filter.tripleStore || !searchRequest.filter.className ">{{'discovery.action-btn-launch-search'
                                | translate}}</button>
                        </form>

                    </div>
                </div>
            </div>
        </div>

        <ng-template #notLoadedState>
            {{'discovery.noData' | translate}}
        </ng-template>
    </div>
</div>



<ng-template #notLoadedState>
    {{'discovery.noData' | translate}}
</ng-template>
<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="square-jelly-box" [fullScreen]="true">
    <p style="color: white"> {{'discovery.search-message'
        | translate}} </p>
</ngx-spinner>

<div *ngIf="responseIsReady && responseData">
    <div class="row">
        <div class="col-12">
            <div class="card flex-fill">
                <div class="card-header">
                    <!--{{ discovery.state-tittle | translate }}-->
                    <legend class="legend">{{'discovery.response-title' | translate}}</legend>
                </div>


                <div class="card-body">

                    <h5 class="card-title">{{'discovery.node' | translate}}: {{ responseData.response.node }}</h5>
                    <h5 class="card-title">{{'discovery.storage' | translate}}: {{ responseData.response.tripleStore }}
                    </h5>
                    <h5 class="card-title">{{'discovery.class' | translate}}: {{ responseData.response.className }}</h5>
                    <h5 class="card-title">{{'discovery.status' | translate}}: {{ responseData.response.status }}</h5>

                    <div *ngIf="responseData.response.status === 'COMPLETED'; else statusPending">

                        <h5 class="card-title">{{'discovery.startDate' | translate}}: {{ responseData.response.startDate
                            }}
                        </h5>
                        <h5 class="card-title">{{'discovery.endDate' | translate}}: {{ responseData.response.endDate }}
                        </h5>

                        <div *ngIf="responseData.response.results.length > 0; else noSimilatirityResultsFound">
                            <legend class="legend">{{'discovery.results-title' | translate}}</legend>
                            <div *ngFor="let item of responseData.response.results">
                                <app-result-item></app-result-item>
                            </div>
                        </div>

                        <ng-template #noSimilatirityResultsFound>
                            {{'discovery.not-result-found' | translate}}
                        </ng-template>

                    </div>

                    <ng-template #statusPending>


                        <h5 class="card-title"> userId:
                            <span class="badge badge-success">{{ responseData.response.userId }}</span>
                        </h5>

                        <h5 class="card-title"> requestCode:
                            <span class="badge badge-success">{{ responseData.response.requestCode }}</span>
                        </h5>

                        <h5 class="card-title"> requestType:
                            <span class="badge badge-success">{{ responseData.response.requestType }}</span>
                        </h5>

                        {{'discovery.pending-message' | translate}}
                    </ng-template>
                </div>
            </div>
        </div>
    </div>
</div>